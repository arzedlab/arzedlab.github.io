<!DOCTYPE html>
<html><head lang="en"><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>CVE-2021-36414: heap-buffer-overflow MP4Box - Arzedlab ğŸªµ</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="A summary of this vulnerability focusing on the affected component, root cause, and security impact. The post highlights how improper validation led to unintended behavior exploitable under specific conditions." />
	<meta property="og:image" content=""/>
	<meta property="og:url" content="http://localhost:1313/posts/cve-2021-36414-1cb3648c0bf480a3b897cfdfea0a9efc/">
  <meta property="og:site_name" content="Arzedlab ğŸªµ">
  <meta property="og:title" content="CVE-2021-36414: heap-buffer-overflow MP4Box">
  <meta property="og:description" content="A summary of this vulnerability focusing on the affected component, root cause, and security impact. The post highlights how improper validation led to unintended behavior exploitable under specific conditions.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-04-04T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-04-04T00:00:00+00:00">
    <meta property="article:tag" content="CVE-2021-36414">
    <meta property="article:tag" content="Heap">
    <meta property="article:tag" content="Heap-Buffer-Overflow">
    <meta property="article:tag" content="MP4Box">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="CVE-2021-36414: heap-buffer-overflow MP4Box">
  <meta name="twitter:description" content="A summary of this vulnerability focusing on the affected component, root cause, and security impact. The post highlights how improper validation led to unintended behavior exploitable under specific conditions.">
<script src="http://localhost:1313/js/feather.min.js"></script>
	
	
        <link href="http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:1313/css/main.7198d56e4fe53ab4610aa7f913b8d3fa7453003ac7791c64a6d6157aecbbced5.css" />

	
	

	
	

	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="http://localhost:1313/">Arzedlab ğŸªµ</a>
	</div>
	<nav>
		
		<a href="/">ğŸ  Home</a>
		
		<a href="/posts">ğŸ—‚ï¸ All posts</a>
		
		<a href="/about">ğŸ’¡ About Me</a>
		
		<a href="/papers">ğŸ“‘ Publications</a>
		
		<a href="/tags">ğŸ·ï¸ Tags</a>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">CVE-2021-36414: heap-buffer-overflow MP4Box</h1>
			<div class="meta">Posted on Apr 4, 2023</div>
		</div>
		

		
		<div class="toc">
		<strong>Table of contents:</strong>
		<nav id="TableOfContents">
  <ul>
    <li><a href="#fix">Fix</a></li>
    <li><a href="#way-of-finding">Way of finding</a></li>
  </ul>
</nav>
		</div>

		<section class="body">
			<h1 id="cve-2021-36414">CVE-2021-36414</h1>
<p>A heap-buffer-overflow has occurred when running program MP4Box,which leads to a Deny of Service caused by dividing zero without sanity check,this can reproduce on the lattest commit.</p>
<p>Here: the main problem is dividing into zero</p>
<p><img src="image.png" alt="image.png"></p>
<p><strong>Assigning <code>block_size</code>:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>block_size <span style="color:#ff79c6">=</span> ent <span style="color:#ff79c6">?</span> ent<span style="color:#ff79c6">-&gt;</span><span style="color:#8be9fd;font-style:italic">sampleDelta</span> : <span style="color:#bd93f9">160</span>;
</span></span></code></pre></div><ul>
<li>This line uses the conditional (ternary) operator to assign a value to <code>block_size</code>.</li>
<li>It checks if <code>ent</code> is not <code>NULL</code>.
<ul>
<li>If <code>ent</code> is valid (i.e., not <code>NULL</code>), <code>block_size</code> is assigned the value of <code>ent-&gt;sampleDelta</code>.</li>
<li>If <code>ent</code> is <code>NULL</code>, <code>block_size</code> is assigned a default value of <code>160</code>.</li>
</ul>
</li>
</ul>
<h2 id="fix">Fix</h2>
<p><img src="image%201.png" alt="image.png"></p>
<p><a href="https://github.com/gpac/gpac/commit/6007c7145eb0fcd29fe05b6e5983a065b42c6b21">https://github.com/gpac/gpac/commit/6007c7145eb0fcd29fe05b6e5983a065b42c6b21</a></p>
<h2 id="way-of-finding">Way of finding</h2>
<p>Bug find out by fuzzing checks.</p>
<p><a href="https://github.com/gpac/gpac/issues/1840">https://github.com/gpac/gpac/issues/1840</a></p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/cve-2021-36414">CVE-2021-36414</a></li>
					
					<li><a href="/tags/heap">Heap</a></li>
					
					<li><a href="/tags/heap-buffer-overflow">heap-buffer-overflow</a></li>
					
					<li><a href="/tags/mp4box">MP4Box</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/arzedlab/" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://www.linkedin.com/in/ravshan-rikhsiev/" rel="me" title="Linkedin"><i data-feather="linkedin"></i></a>
    <a class="border"></a><a class="soc" href="https://twitter.com/arzedlab/" rel="me" title="Twitter"><i data-feather="twitter"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2025  Â© Ravshan | Made with Love â¤ï¸ <a href="https://twitter.com/arzedlab/"> My Twitter ğŸª½</a>
  </div>
</footer>
<script>
  feather.replace()
</script></div>
    </body>
</html>
